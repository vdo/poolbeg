server:
  address: "0.0.0.0"
  port: 8080
  metrics:
    address: "0.0.0.0"
    port: 9090
    path: "/metrics"

  # API key authentication (optional)
  auth:
    enabled: false
    api_keys: []
    # api_keys:
    #   - "your-secret-api-key-1"
    #   - "your-secret-api-key-2"

  # Client-side rate limit (requests per second across all endpoints)
  max_rps: 1000

  # Maximum request body size in bytes (default: 1MB)
  max_body_size: 1048576

  # Maximum number of requests in a single JSON-RPC batch
  max_batch_size: 100

  # Maximum concurrent WebSocket connections
  max_ws_connections: 1024

  # Block methods matching these prefixes (e.g. admin_, debug_)
  blocked_methods:
    - "admin_"
    - "debug_"
    - "personal_"
    - "miner_"
    - "txpool_"

cache:
  redis:
    url: "${REDIS_URL:-redis://localhost:6379}"
    pool_size: 16
    db: 0
  policies:
    # Finalized data = cache permanently
    - methods: ["eth_getBlockByHash", "eth_getTransactionByHash", "eth_getTransactionReceipt"]
      finality: finalized
      ttl: "0"
    # Unfinalized/latest = short TTL
    - methods: ["eth_getBlockByNumber", "eth_getBalance", "eth_getCode", "eth_getStorageAt"]
      finality: unfinalized
      ttl: "2s"
    # Never cache
    - methods: ["eth_sendRawTransaction", "eth_estimateGas", "eth_call"]
      finality: any
      ttl: "-1"
    # Default catch-all
    - methods: ["*"]
      finality: finalized
      ttl: "3600s"
    - methods: ["*"]
      finality: unfinalized
      ttl: "3s"

chains:
  - name: ethereum
    chain_id: 1
    expected_block_time: "12s"
    finality_depth: 64
    route: /ethereum
    # Upstream selection strategy: round_robin (default), random, lowest_latency
    strategy: round_robin
    auto_public: true
    upstreams:
      # - id: infura-eth
      #   role: primary
      #   http_url: "https://mainnet.infura.io/v3/${INFURA_KEY}"
      #   ws_url: "wss://mainnet.infura.io/ws/v3/${INFURA_KEY}"
      #   max_rps: 50
      # - id: ankr-eth
      #   role: secondary
      #   http_url: "https://rpc.ankr.com/eth/${ANKR_KEY}"
      #   max_rps: 30
      - id: public-eth
        role: fallback
        http_url: "https://ethereum-rpc.publicnode.com"
        max_rps: 10

  - name: arbitrum
    chain_id: 42161
    expected_block_time: "250ms"
    finality_depth: 100
    route: /arbitrum
    # Automatically fetch public RPC endpoints for this chain_id from the
    # eRPC public endpoints registry and add them as fallback upstreams.
    auto_public: true
    strategy: lowest_latency
    # How long to wait before retrying a disabled upstream (default: 24h)
    disabled_retry_interval: "24h"
    # upstreams:
    #   - id: infura-arb
    #     role: primary
    #     http_url: "https://arbitrum-mainnet.infura.io/v3/${INFURA_KEY}"
    #     ws_url: "wss://arbitrum-mainnet.infura.io/ws/v3/${INFURA_KEY}"
    #     max_rps: 50
    #   - id: ankr-arb
    #     role: secondary
    #     http_url: "https://rpc.ankr.com/arbitrum/${ANKR_KEY}"
    #     max_rps: 30
  - name: arbitrum-sepolia
    chain_id: 421614
    expected_block_time: "250ms"
    finality_depth: 100
    route: /arbitrum-sepolia
    auto_public: true
    strategy: random

  # Example: a chain with ONLY auto-discovered public endpoints (no manual upstreams)
  # - name: optimism
  #   chain_id: 10
  #   expected_block_time: "2s"
  #   finality_depth: 64
  #   route: /optimism
  #   auto_public: true
  #   upstreams: []
  - name: tron-nile
    chain_id: 728126453
    expected_block_time: "3s"
    finality_depth: 10
    route: /tron-nile
    strategy: random
    upstreams:
      - id: tron-nile
        role: primary
        expected_block_time: "3s"
        http_url: "https://nile.trongrid.io/jsonrpc"
        max_rps: 10
